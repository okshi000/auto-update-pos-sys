import{a as $,f as z,k as x,t as c,j as s,B as R,S as U}from"./index-JnHVxLbD.js";import{r as t}from"./vendor-react-DsCSLZ3L.js";import{M as V}from"./Modal-D5rG5aoT.js";import{C as G}from"./ConfirmDialog-D3-IL07m.js";import{D as J}from"./DataTable-DJ4uobWj.js";import{F as o}from"./FormField-vLBzEDKV.js";import{F as K}from"./FormError-BBWAzQth.js";import{F as Q}from"./FormActions-Dnk-uwAR.js";import"./vendor-utils-DMdnf9MG.js";import"./vendor-charts-DGg1Za7c.js";import"./vendor-icons-DU-kWQ55.js";function ne(){const{t:a}=$(),{hasPermission:v}=z(),k=v("suppliers.create"),w=v("suppliers.edit"),L=v("suppliers.delete"),[f,E]=t.useState([]),[D,S]=t.useState([]),[F,b]=t.useState(!0),[d,A]=t.useState(""),[I,n]=t.useState(!1),[p,C]=t.useState(null),[g,j]=t.useState(null),[r,l]=t.useState({name:"",code:"",email:"",phone:"",address:"",tax_number:"",is_active:!0}),[u,y]=t.useState({}),[N,m]=t.useState(null),[M,_]=t.useState(!1),h=t.useCallback(async()=>{b(!0);try{const e=await x.listAll();E(e)}catch{c.error(a("error.load_failed","Failed to load suppliers"))}finally{b(!1)}},[a]);t.useEffect(()=>{if(!d)S(f);else{const e=d.toLowerCase();S(f.filter(i=>i.name.toLowerCase().includes(e)||i.code?.toLowerCase().includes(e)||i.email?.toLowerCase().includes(e)||i.phone?.toLowerCase().includes(e)))}},[f,d]),t.useEffect(()=>{h()},[h]);const P=()=>{l({name:"",code:"",email:"",phone:"",address:"",tax_number:"",is_active:!0}),y({}),m(null)},B=()=>{P(),C(null),n(!0)},T=e=>{l({name:e.name,code:e.code||"",email:e.email||"",phone:e.phone||"",address:e.address||"",tax_number:e.tax_number||"",is_active:e.is_active}),y({}),m(null),C(e),n(!0)},q=()=>{const e={};return r.name.trim()||(e.name=a("validation.required","This field is required")),r.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.email)&&(e.email=a("validation.invalid_email","Invalid email address")),y(e),Object.keys(e).length===0},H=async e=>{if(e.preventDefault(),!!q()){_(!0),m(null);try{p?(await x.update(p.id,r),c.success(a("suppliers.updated","Supplier updated"))):(await x.create(r),c.success(a("suppliers.created","Supplier created"))),n(!1),h()}catch(i){m(i instanceof Error?i.message:a("error.save_failed","Failed to save"))}finally{_(!1)}}},O=async()=>{if(g)try{await x.delete(g),c.success(a("suppliers.deleted","Supplier deleted")),j(null),h()}catch{c.error(a("error.delete_failed","Failed to delete supplier"))}},W=[{key:"code",header:a("suppliers.code","Code"),width:"100px",render:e=>s.jsx("span",{className:"font-mono text-sm",style:{color:"var(--color-gray-600)"},children:e.code||"-"})},{key:"name",header:a("suppliers.name","Name"),render:e=>s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",style:{color:"var(--color-gray-900)"},children:e.name}),e.email&&s.jsx("div",{className:"text-sm",style:{color:"var(--color-gray-500)"},children:e.email})]})},{key:"phone",header:a("suppliers.phone","Phone"),hideOnMobile:!0,render:e=>s.jsx("span",{style:{color:"var(--color-gray-600)"},children:e.phone||"-"})},{key:"is_active",header:a("common.status","Status"),align:"center",width:"100px",render:e=>s.jsx(R,{variant:e.is_active?"success":"default",dot:!0,children:e.is_active?a("common.active","Active"):a("common.inactive","Inactive")})},{key:"actions",header:"",align:"end",width:"100px",render:e=>s.jsxs("div",{className:"flex items-center justify-end gap-2",children:[w&&s.jsx("button",{onClick:()=>T(e),className:"p-2 rounded-lg hover:bg-gray-100",title:a("common.edit","Edit"),children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),L&&s.jsx("button",{onClick:()=>j(e.id),className:"p-2 rounded-lg hover:bg-red-100 text-red-600",title:a("common.delete","Delete"),children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})}];return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[s.jsx("h1",{className:"text-2xl font-semibold",style:{color:"var(--color-gray-900)"},children:a("nav.suppliers","Suppliers")}),k&&s.jsxs("button",{onClick:B,className:"btn btn-primary",children:[s.jsx("svg",{className:"w-5 h-5 me-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),a("suppliers.add","Add Supplier")]})]}),s.jsx("div",{className:"card",children:s.jsx(U,{value:d,onChange:A,placeholder:a("suppliers.search_placeholder","Search by name, code, email...")})}),s.jsx("div",{className:"card p-0",children:s.jsx(J,{columns:W,data:D,keyExtractor:e=>e.id,isLoading:F,emptyIcon:"ðŸ­",emptyTitle:a("suppliers.empty","No suppliers found"),emptyDescription:a("suppliers.empty_desc","Add your first supplier to get started")})}),s.jsx(V,{isOpen:I,onClose:()=>n(!1),title:p?a("suppliers.edit","Edit Supplier"):a("suppliers.add","Add Supplier"),size:"md",children:s.jsxs("form",{onSubmit:H,children:[N&&s.jsx(K,{message:N}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(o,{label:a("suppliers.name","Name"),required:!0,error:u.name,children:s.jsx("input",{type:"text",value:r.name,onChange:e=>l({...r,name:e.target.value}),className:`input ${u.name?"input-error":""}`,placeholder:a("suppliers.name_placeholder","Supplier name")})}),s.jsx(o,{label:a("suppliers.code","Code"),children:s.jsx("input",{type:"text",value:r.code||"",onChange:e=>l({...r,code:e.target.value}),className:"input",placeholder:a("suppliers.code_placeholder","SUP001")})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(o,{label:a("suppliers.email","Email"),error:u.email,children:s.jsx("input",{type:"email",value:r.email||"",onChange:e=>l({...r,email:e.target.value}),className:`input ${u.email?"input-error":""}`,placeholder:"supplier@example.com"})}),s.jsx(o,{label:a("suppliers.phone","Phone"),children:s.jsx("input",{type:"tel",value:r.phone||"",onChange:e=>l({...r,phone:e.target.value}),className:"input",placeholder:"+218..."})})]}),s.jsx(o,{label:a("suppliers.address","Address"),children:s.jsx("textarea",{value:r.address||"",onChange:e=>l({...r,address:e.target.value}),className:"input",rows:2,placeholder:a("suppliers.address_placeholder","Full address...")})}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(o,{label:a("suppliers.tax_number","Tax Number"),children:s.jsx("input",{type:"text",value:r.tax_number||"",onChange:e=>l({...r,tax_number:e.target.value}),className:"input",placeholder:a("suppliers.tax_placeholder","Tax ID")})}),s.jsx(o,{label:a("common.status","Status"),children:s.jsxs("label",{className:"flex items-center gap-3 cursor-pointer mt-2",children:[s.jsx("input",{type:"checkbox",checked:r.is_active,onChange:e=>l({...r,is_active:e.target.checked}),className:"w-5 h-5 rounded",style:{accentColor:"var(--color-primary-600)"}}),s.jsx("span",{style:{color:"var(--color-gray-700)"},children:a("suppliers.is_active","Active supplier")})]})})]}),s.jsx(Q,{onCancel:()=>n(!1),isSubmitting:M,submitLabel:p?a("common.save","Save"):a("common.create","Create")})]})}),s.jsx(G,{isOpen:g!==null,onClose:()=>j(null),onConfirm:O,title:a("suppliers.delete","Delete Supplier"),message:a("suppliers.delete_confirm","Are you sure you want to delete this supplier?"),confirmLabel:a("common.delete","Delete"),variant:"danger"})]})}export{ne as SuppliersPage,ne as default};
