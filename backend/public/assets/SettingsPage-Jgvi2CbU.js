import{e as Q,j as e,C as $,c as E,y as H,z as G,B as _,A as V,D as b,E as Z,a as W,F as M,t as h,G as ee,m as C,f as se,H as B,L as O}from"./index-BnL1Xpg8.js";import{r as o,c as F}from"./vendor-react-DsCSLZ3L.js";import{F as g}from"./FormField-Yls4ILqE.js";import{F as ae}from"./FormError-DDW1e3jQ.js";import{H as te,p as re,C as le,q as P,R as D,r as J,c as f,T as ne,m as I,s as T,b as L,F as ie,t as ce,u as de,v as oe,I as me,w as xe,e as q,P as ge}from"./vendor-icons-DU-kWQ55.js";import{A as X,M as he}from"./Modal-D_3ZWCmE.js";import"./vendor-utils-DMdnf9MG.js";import"./vendor-charts-DGg1Za7c.js";const ue=({className:t})=>{const{isOnline:s,isSyncing:i,pendingCount:x,isCatalogReady:n,isLoadingCatalog:m,lastCatalogSync:N,syncCatalog:w,syncPendingSales:v,clearOfflineData:S,getPendingSales:k}=Q(),[u,l]=o.useState([]),[c,p]=o.useState(!1),y=F.useRef(x),j=F.useCallback(async()=>{const r=await k();l(r)},[k]);F.useEffect(()=>{j()},[]),F.useEffect(()=>{y.current!==x&&(y.current=x,j())},[x,j]);const Y=async()=>{try{await w()}catch(r){console.error("Failed to sync catalog:",r)}},a=async()=>{const r=await v();r.synced>0&&console.log(`Synced ${r.synced} sales, ${r.failed} failed`)},z=async()=>{await S(),l([]),p(!1)},d=r=>{switch(r){case"pending":return e.jsx(_,{variant:"warning",children:"Pending"});case"syncing":return e.jsx(_,{variant:"info",children:"Syncing"});case"synced":return e.jsx(_,{variant:"success",children:"Synced"});case"failed":return e.jsx(_,{variant:"danger",children:"Failed"});default:return e.jsx(_,{children:r})}};return e.jsxs($,{className:E("",t),children:[e.jsx(H,{children:e.jsxs(G,{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-5 w-5"}),"Offline Storage & Sync"]}),e.jsx(_,{variant:s?"success":"danger",children:s?"Online":"Offline"})]})}),e.jsxs(V,{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[s?e.jsx(re,{className:"h-5 w-5 text-green-600"}):e.jsx(le,{className:"h-5 w-5 text-red-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s?"Connected to server":"No connection"}),e.jsx("p",{className:"text-sm text-gray-500",children:s?"Sales will sync automatically":"Sales will be saved locally"})]})]})}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(P,{className:E("h-5 w-5",n?"text-green-600":"text-yellow-600")}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Product Catalog"}),e.jsx("p",{className:"text-sm text-gray-500",children:n?`Cached ${N?pe(N):""}`:"Not cached - offline mode limited"})]})]}),e.jsxs(b,{size:"sm",variant:"outline",onClick:Y,disabled:!s||m,children:[e.jsx(D,{className:E("h-4 w-4 mr-1",m&&"animate-spin")}),m?"Syncing...":"Sync"]})]}),e.jsxs("div",{className:"border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border-b bg-gray-50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"font-medium",children:"Pending Sales"}),x>0&&e.jsx(_,{variant:"warning",children:x})]}),x>0&&e.jsxs(b,{size:"sm",onClick:a,disabled:!s||i,children:[e.jsx(D,{className:E("h-4 w-4 mr-1",i&&"animate-spin")}),i?"Syncing...":"Sync All"]})]}),u.length===0?e.jsxs("div",{className:"p-4 text-center text-gray-500",children:[e.jsx(f,{className:"h-8 w-8 mx-auto mb-2 text-green-500"}),e.jsx("p",{children:"No pending sales"})]}):e.jsx("div",{className:"max-h-60 overflow-y-auto",children:u.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-3 border-b last:border-b-0 hover:bg-gray-50",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-sm font-medium",children:[r.items.length," item",r.items.length!==1?"s":""," •"," ","$",r.total.toFixed(2)]}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(r.created_at).toLocaleString()}),r.error_message&&e.jsxs("p",{className:"text-xs text-red-500 mt-1",children:[e.jsx(ne,{className:"h-3 w-3 inline mr-1"}),r.error_message]})]}),d(r.status)]},r.id))})]})]}),e.jsx(Z,{className:"border-t pt-4",children:c?e.jsxs("div",{className:"flex items-center justify-between w-full gap-2",children:[e.jsx("span",{className:"text-sm text-red-600",children:"This will delete all cached data and pending sales!"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{size:"sm",variant:"outline",onClick:()=>p(!1),children:"Cancel"}),e.jsx(b,{size:"sm",variant:"destructive",onClick:z,children:"Confirm Delete"})]})]}):e.jsxs(b,{variant:"outline",size:"sm",className:"text-red-600 hover:bg-red-50",onClick:()=>p(!0),children:[e.jsx(I,{className:"h-4 w-4 mr-1"}),"Clear All Offline Data"]})})]})};function pe(t){return t.toLocaleDateString(void 0,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}const R={idle:{label:"Ready",icon:e.jsx(ge,{className:"w-5 h-5"})},checking:{label:"Checking for updates...",icon:e.jsx(D,{className:"w-5 h-5 animate-spin"})},downloading:{label:"Downloading update...",icon:e.jsx(T,{className:"w-5 h-5 animate-pulse"})},backing_up:{label:"Creating backup...",icon:e.jsx(P,{className:"w-5 h-5 animate-pulse"})},installing:{label:"Installing update...",icon:e.jsx(q,{className:"w-5 h-5 animate-spin"})},migrating:{label:"Running migrations...",icon:e.jsx(P,{className:"w-5 h-5 animate-pulse"})},completing:{label:"Finalizing...",icon:e.jsx(q,{className:"w-5 h-5 animate-spin"})},done:{label:"Update complete!",icon:e.jsx(f,{className:"w-5 h-5 text-green-500"})},error:{label:"Update failed",icon:e.jsx(L,{className:"w-5 h-5 text-red-500"})}},je={feature:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",fix:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",security:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",improvement:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",breaking:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200"};function be({onUpdateComplete:t}){const{t:s}=W(),[i,x]=o.useState(null),[n,m]=o.useState({stage:"idle",progress:0,message:""}),[N,w]=o.useState(!1),[v,S]=o.useState(!1),[k,u]=o.useState(!1),[l,c]=o.useState(null),[p,y]=o.useState(null),j=o.useCallback(async()=>{w(!0),y(null),m({stage:"checking",progress:10,message:s("system.checking_updates","Checking for updates...")});try{const d=await M.checkForUpdates();x(d),c(new Date),m({stage:"idle",progress:0,message:""}),d.is_update_available?h.info(s("system.update_available","A new version is available: {{version}}").replace("{{version}}",d.latest_version)):h.success(s("system.up_to_date","Your system is up to date!"))}catch(d){const r=d instanceof Error?d.message:s("system.check_failed","Failed to check for updates");y(r),m({stage:"error",progress:0,message:r}),h.error(r)}finally{w(!1)}},[s]),Y=async()=>{u(!1),y(null);const d=[{stage:"backing_up",progress:20,duration:2e3},{stage:"downloading",progress:40,duration:3e3},{stage:"installing",progress:60,duration:3e3},{stage:"migrating",progress:80,duration:2e3},{stage:"completing",progress:95,duration:1500}];try{for(const{stage:r,progress:A,duration:K}of d){if(m({stage:r,progress:A,message:R[r].label}),r==="installing"){const U=await M.update();if(!U.success)throw new Error(U.message)}await new Promise(U=>setTimeout(U,K))}m({stage:"done",progress:100,message:s("system.update_success","Update completed successfully!")}),h.success(s("system.update_success","System updated successfully!")),setTimeout(async()=>{await j(),t?.()},2e3)}catch(r){const A=r instanceof Error?r.message:s("system.update_failed","Update failed");y(A),m({stage:"error",progress:0,message:A,details:s("system.rollback_info","The system has been rolled back to the previous version.")}),h.error(A)}};o.useEffect(()=>{j()},[]);const a=()=>{if(!l)return null;const r=Math.floor((new Date().getTime()-l.getTime())/1e3);return r<60?s("system.just_now","Just now"):r<3600?s("system.minutes_ago","{{count}} minutes ago").replace("{{count}}",String(Math.floor(r/60))):r<86400?s("system.hours_ago","{{count}} hours ago").replace("{{count}}",String(Math.floor(r/3600))):l.toLocaleDateString()},z=["downloading","backing_up","installing","migrating","completing"].includes(n.stage);return e.jsxs(e.Fragment,{children:[e.jsxs($,{className:"overflow-hidden",children:[e.jsx(H,{className:"pb-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-50 dark:bg-blue-900/30",children:e.jsx(D,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx(G,{children:s("system.updates","System Updates")}),e.jsx(ee,{children:s("system.updates_desc","Keep your system up to date with the latest features and security patches")})]})]})})}),e.jsxs(V,{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 p-4 rounded-xl bg-gray-50 dark:bg-zinc-800/50",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:s("system.current_version","Current Version")}),e.jsx("span",{className:"px-2 py-0.5 text-sm font-semibold rounded-full bg-gray-200 dark:bg-zinc-700 text-gray-800 dark:text-gray-200",children:i?.current_version||"..."})]}),l&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-400",children:[e.jsx(J,{className:"w-3 h-3"}),s("system.last_checked","Last checked"),": ",a()]})]}),e.jsx(b,{variant:"outline",size:"sm",onClick:j,disabled:N||z,leftIcon:e.jsx(D,{className:`w-4 h-4 ${N?"animate-spin":""}`}),children:s("system.check_now","Check Now")})]}),e.jsxs(X,{mode:"wait",children:[i?.is_update_available&&n.stage==="idle"&&e.jsx(C.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"p-4 rounded-xl border-2 border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-2 rounded-full bg-blue-100 dark:bg-blue-900/50",children:e.jsx(T,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-semibold text-blue-900 dark:text-blue-100",children:s("system.new_version","New Version Available")}),e.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300 mt-1",children:[s("system.version_info","Version {{version}} is ready to install").replace("{{version}}",i.latest_version),i.download_size&&` (${i.download_size})`]}),i.breaking_changes&&i.breaking_changes.length>0&&e.jsxs("div",{className:"mt-3 p-3 rounded-lg bg-orange-100 dark:bg-orange-900/30 border border-orange-200 dark:border-orange-800",children:[e.jsxs("div",{className:"flex items-center gap-2 text-orange-800 dark:text-orange-200 font-medium text-sm",children:[e.jsx(L,{className:"w-4 h-4"}),s("system.breaking_changes","Breaking Changes")]}),e.jsx("ul",{className:"mt-2 space-y-1 text-sm text-orange-700 dark:text-orange-300",children:i.breaking_changes.map((d,r)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-1.5 w-1 h-1 rounded-full bg-orange-500 flex-shrink-0"}),d]},r))})]}),i.changelog&&i.changelog.length>0&&e.jsxs("button",{onClick:()=>S(!v),className:"flex items-center gap-1 mt-3 text-sm font-medium text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200 transition-colors",children:[e.jsx(ie,{className:"w-4 h-4"}),s("system.view_changelog","View Changelog"),v?e.jsx(ce,{className:"w-4 h-4"}):e.jsx(de,{className:"w-4 h-4"})]}),e.jsx(X,{children:v&&i.changelog&&e.jsx(C.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:e.jsx("div",{className:"mt-3 space-y-2 max-h-60 overflow-y-auto",children:i.changelog.map((d,r)=>e.jsxs("div",{className:"flex items-start gap-3 p-2 rounded-lg bg-white/50 dark:bg-zinc-800/50",children:[e.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full ${je[d.type]}`,children:d.type}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 flex-1",children:d.description})]},r))})})}),e.jsx("div",{className:"flex items-center gap-3 mt-4",children:e.jsx(b,{variant:"primary",onClick:()=>u(!0),rightIcon:e.jsx(oe,{className:"w-4 h-4"}),children:s("system.install_update","Install Update")})})]})]})}),i&&!i.is_update_available&&n.stage==="idle"&&e.jsx(C.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"p-4 rounded-xl bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(f,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-green-900 dark:text-green-100",children:s("system.up_to_date_title","System is Up to Date")}),e.jsx("p",{className:"text-sm text-green-700 dark:text-green-300",children:s("system.running_latest","You are running the latest version of the system.")})]})]})}),z&&e.jsx(C.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"p-4 rounded-xl bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[R[n.stage].icon,e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-blue-900 dark:text-blue-100",children:R[n.stage].label}),n.message&&e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:n.message})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-2 rounded-full bg-blue-200 dark:bg-blue-900 overflow-hidden",children:e.jsx(C.div,{className:"h-full bg-blue-600 dark:bg-blue-400",initial:{width:0},animate:{width:`${n.progress}%`},transition:{duration:.5}})}),e.jsxs("div",{className:"flex justify-between text-xs text-blue-600 dark:text-blue-400",children:[e.jsxs("span",{children:[n.progress,"%"]}),e.jsx("span",{children:s("system.do_not_close","Please do not close this window")})]})]})]})}),n.stage==="done"&&e.jsx(C.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"p-4 rounded-xl bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-green-100 dark:bg-green-900/50",children:e.jsx(f,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-green-900 dark:text-green-100",children:s("system.update_complete","Update Complete!")}),e.jsx("p",{className:"text-sm text-green-700 dark:text-green-300",children:s("system.refresh_page","The page will refresh automatically to apply changes.")})]})]})}),n.stage==="error"&&e.jsx(C.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"p-4 rounded-xl bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-red-100 dark:bg-red-900/50",children:e.jsx(L,{className:"w-5 h-5 text-red-600 dark:text-red-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-red-900 dark:text-red-100",children:s("system.update_failed_title","Update Failed")}),e.jsx("p",{className:"text-sm text-red-700 dark:text-red-300 mt-1",children:p||n.message}),n.details&&e.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mt-2",children:n.details}),e.jsx(b,{variant:"outline",size:"sm",onClick:j,className:"mt-3",leftIcon:e.jsx(D,{className:"w-4 h-4"}),children:s("system.try_again","Try Again")})]})]})})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-gray-50 dark:bg-zinc-800/50 text-sm",children:[e.jsx(me,{className:"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0"}),e.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:e.jsx("p",{children:s("system.update_info","Updates are downloaded from a secure server and include the latest features, bug fixes, and security patches. A backup of your database is automatically created before each update.")})})]}),i?.requires_migration&&e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 text-sm",children:[e.jsx(P,{className:"w-4 h-4 text-amber-600 dark:text-amber-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-amber-700 dark:text-amber-300",children:[e.jsx("p",{className:"font-medium",children:s("system.migration_required","Database migration required")}),e.jsx("p",{className:"mt-1",children:s("system.migration_info","This update includes database changes. Your data will be automatically migrated to the new structure.")})]})]})]})]}),e.jsx(he,{isOpen:k,onClose:()=>u(!1),title:s("system.confirm_update","Confirm Update"),size:"md",footer:e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(b,{variant:"outline",onClick:()=>u(!1),children:s("common.cancel","Cancel")}),e.jsx(b,{variant:"primary",onClick:Y,leftIcon:e.jsx(T,{className:"w-4 h-4"}),children:s("system.start_update","Start Update")})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-xl bg-blue-50 dark:bg-blue-900/20",children:[e.jsx(xe,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-900 dark:text-blue-100",children:s("system.update_version","Updating to version {{version}}").replace("{{version}}",i?.latest_version||"")}),i?.download_size&&e.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[s("system.download_size","Download size"),": ",i.download_size]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:s("system.what_happens","What will happen:")}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(f,{className:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),s("system.step_backup","A backup of your database will be created")]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(f,{className:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),s("system.step_download","The update will be downloaded and verified")]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(f,{className:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),s("system.step_install","New files will be installed")]}),i?.requires_migration&&e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(f,{className:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),s("system.step_migrate","Database will be migrated")]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(f,{className:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),s("system.step_restart","The application will restart automatically")]})]})]}),e.jsx("div",{className:"p-3 rounded-lg bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800",children:e.jsxs("div",{className:"flex items-start gap-2 text-sm text-amber-700 dark:text-amber-300",children:[e.jsx(L,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),e.jsx("p",{children:s("system.update_warning","Please do not close the browser or turn off your computer during the update process.")})]})})]})})]})}function Se(){const{t,locale:s,setLocale:i}=W(),{hasPermission:x}=se(),n=x("settings.edit"),m=x("system.manage"),[N,w]=o.useState(!0),[v,S]=o.useState(!1),[k,u]=o.useState(null),[l,c]=o.useState({}),p=o.useCallback(async()=>{w(!0);try{const a=await B.get();c(a)}catch{h.error(t("error.load_failed","Failed to load settings"))}finally{w(!1)}},[t]),y=async()=>{S(!0),u(null);try{await B.update(l),h.success(t("settings.saved","Settings saved successfully")),p()}catch(a){u(a instanceof Error?a.message:t("error.save_failed","Failed to save"))}finally{S(!1)}},j=async()=>{try{const a=await M.clearCache();h.success(a.message)}catch(a){h.error(a instanceof Error?a.message:t("system.clear_cache_failed","Failed to clear cache"))}},Y=async()=>{try{const a=await M.backup();h.success(a.message)}catch(a){h.error(a instanceof Error?a.message:t("system.backup_failed","Backup failed"))}};return o.useEffect(()=>{p()},[p]),N?e.jsx("div",{className:"py-12",children:e.jsx(O,{fullPage:!0})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:e.jsx("h1",{className:"text-2xl font-semibold",style:{color:"var(--color-gray-900)"},children:t("nav.settings","Settings")})}),k&&e.jsx("div",{className:"card",children:e.jsx(ae,{message:k})}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",style:{color:"var(--color-gray-900)"},children:t("settings.general","General Settings")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(g,{label:t("settings.company_name","Company Name"),children:e.jsx("input",{type:"text",value:l.company_name||"",onChange:a=>c({...l,company_name:a.target.value}),className:"input",disabled:!n,placeholder:t("settings.company_placeholder","Your Company Name")})}),e.jsx(g,{label:t("settings.phone","Phone Number"),children:e.jsx("input",{type:"tel",value:l.phone||"",onChange:a=>c({...l,phone:a.target.value}),className:"input",disabled:!n,placeholder:"+218 XX XXX XXXX"})}),e.jsx(g,{label:t("settings.email","Email"),children:e.jsx("input",{type:"email",value:l.email||"",onChange:a=>c({...l,email:a.target.value}),className:"input",disabled:!n,placeholder:"contact@company.com"})}),e.jsx(g,{label:t("settings.address","Address"),children:e.jsx("input",{type:"text",value:l.address||"",onChange:a=>c({...l,address:a.target.value}),className:"input",disabled:!n,placeholder:t("settings.address_placeholder","Business address")})})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",style:{color:"var(--color-gray-900)"},children:t("settings.regional","Regional Settings")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(g,{label:t("settings.language","Language"),children:e.jsxs("select",{value:s,onChange:a=>i(a.target.value),className:"input",children:[e.jsx("option",{value:"en",children:"English"}),e.jsx("option",{value:"ar",children:"العربية"})]})}),e.jsx(g,{label:t("settings.currency","Currency"),children:e.jsx("input",{type:"text",value:l.currency||"LYD",onChange:a=>c({...l,currency:a.target.value}),className:"input",disabled:!n})}),e.jsx(g,{label:t("settings.timezone","Timezone"),children:e.jsxs("select",{value:l.timezone||"Africa/Tripoli",onChange:a=>c({...l,timezone:a.target.value}),className:"input",disabled:!n,children:[e.jsx("option",{value:"Africa/Tripoli",children:"Africa/Tripoli (Libya)"}),e.jsx("option",{value:"UTC",children:"UTC"}),e.jsx("option",{value:"Africa/Cairo",children:"Africa/Cairo (Egypt)"}),e.jsx("option",{value:"Africa/Tunis",children:"Africa/Tunis (Tunisia)"})]})}),e.jsx(g,{label:t("settings.date_format","Date Format"),children:e.jsxs("select",{value:l.date_format||"DD/MM/YYYY",onChange:a=>c({...l,date_format:a.target.value}),className:"input",disabled:!n,children:[e.jsx("option",{value:"DD/MM/YYYY",children:"DD/MM/YYYY"}),e.jsx("option",{value:"MM/DD/YYYY",children:"MM/DD/YYYY"}),e.jsx("option",{value:"YYYY-MM-DD",children:"YYYY-MM-DD"})]})})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",style:{color:"var(--color-gray-900)"},children:t("settings.pos","POS Settings")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(g,{label:t("settings.receipt_header","Receipt Header"),children:e.jsx("textarea",{value:l.receipt_header||"",onChange:a=>c({...l,receipt_header:a.target.value}),className:"input",rows:3,disabled:!n,placeholder:t("settings.receipt_header_placeholder","Text shown at top of receipts")})}),e.jsx(g,{label:t("settings.receipt_footer","Receipt Footer"),children:e.jsx("textarea",{value:l.receipt_footer||"",onChange:a=>c({...l,receipt_footer:a.target.value}),className:"input",rows:3,disabled:!n,placeholder:t("settings.receipt_footer_placeholder","Text shown at bottom of receipts")})}),e.jsx(g,{label:t("settings.low_stock_threshold","Low Stock Threshold"),children:e.jsx("input",{type:"number",min:"0",value:l.low_stock_threshold||10,onChange:a=>c({...l,low_stock_threshold:parseInt(a.target.value)||10}),className:"input",disabled:!n})})]}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:l.allow_negative_stock||!1,onChange:a=>c({...l,allow_negative_stock:a.target.checked}),className:"w-5 h-5 rounded",style:{accentColor:"var(--color-primary-600)"},disabled:!n}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",style:{color:"var(--color-gray-900)"},children:t("settings.allow_negative","Allow Negative Stock")}),e.jsx("p",{className:"text-sm",style:{color:"var(--color-gray-500)"},children:t("settings.allow_negative_desc","Allow sales even when stock is zero or below")})]})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:l.require_customer||!1,onChange:a=>c({...l,require_customer:a.target.checked}),className:"w-5 h-5 rounded",style:{accentColor:"var(--color-primary-600)"},disabled:!n}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",style:{color:"var(--color-gray-900)"},children:t("settings.require_customer","Require Customer Selection")}),e.jsx("p",{className:"text-sm",style:{color:"var(--color-gray-500)"},children:t("settings.require_customer_desc","Require a customer to be selected before checkout")})]})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:l.print_receipt_auto||!1,onChange:a=>c({...l,print_receipt_auto:a.target.checked}),className:"w-5 h-5 rounded",style:{accentColor:"var(--color-primary-600)"},disabled:!n}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",style:{color:"var(--color-gray-900)"},children:t("settings.auto_print","Auto-Print Receipts")}),e.jsx("p",{className:"text-sm",style:{color:"var(--color-gray-500)"},children:t("settings.auto_print_desc","Automatically print receipt after each sale")})]})]})]})]}),e.jsx(ue,{}),m&&e.jsx(be,{onUpdateComplete:()=>p()}),m&&e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",style:{color:"var(--color-gray-900)"},children:t("system.management","System Management")}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between p-4 rounded-lg",style:{backgroundColor:"var(--color-gray-50)"},children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(I,{className:"w-5 h-5",style:{color:"var(--color-orange-600)"}}),e.jsx("span",{className:"font-medium",style:{color:"var(--color-gray-900)"},children:t("system.clear_cache","Clear Cache")})]}),e.jsx("p",{className:"text-sm",style:{color:"var(--color-gray-500)"},children:t("system.clear_cache_desc","Clear application cache and compiled views")})]}),e.jsxs("button",{onClick:j,className:"btn btn-secondary",children:[e.jsx(I,{className:"w-4 h-4"}),t("system.clear","Clear")]})]}),e.jsxs("div",{className:"flex items-start justify-between p-4 rounded-lg",style:{backgroundColor:"var(--color-gray-50)"},children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(T,{className:"w-5 h-5",style:{color:"var(--color-green-600)"}}),e.jsx("span",{className:"font-medium",style:{color:"var(--color-gray-900)"},children:t("system.backup","Database Backup")})]}),e.jsx("p",{className:"text-sm",style:{color:"var(--color-gray-500)"},children:t("system.backup_desc","Create a backup of the database")})]}),e.jsxs("button",{onClick:Y,className:"btn btn-secondary",children:[e.jsx(T,{className:"w-4 h-4"}),t("system.backup_now","Backup")]})]})]})]}),n&&e.jsx("div",{className:"card",children:e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:y,disabled:v,className:"btn btn-primary",children:v?e.jsx(O,{size:"sm"}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),t("settings.save","Save Settings")]})})})})]})}export{Se as SettingsPage,Se as default};
